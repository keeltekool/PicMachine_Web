<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PicMachine</title>
  <link rel="stylesheet" href="style.css">
  <!-- Supabase JS Library -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <!-- Theme toggle button -->
  <button id="fullscreen-toggle" class="fullscreen-toggle" aria-label="Toggle fullscreen">
    <svg id="expand-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="15 3 21 3 21 9"></polyline>
      <polyline points="9 21 3 21 3 15"></polyline>
      <line x1="21" y1="3" x2="14" y2="10"></line>
      <line x1="3" y1="21" x2="10" y2="14"></line>
    </svg>
    <svg id="shrink-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="4 14 10 14 10 20"></polyline>
      <polyline points="20 10 14 10 14 4"></polyline>
      <line x1="14" y1="10" x2="21" y2="3"></line>
      <line x1="3" y1="21" x2="10" y2="14"></line>
    </svg>
  </button>

  <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
    <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
    <svg id="moon-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
    </svg>
  </button>

  <!-- Auth Screen: Login/Sign Up -->
  <div id="auth-screen">
    <div class="auth-content">
      <h1>PicMachine</h1>
      <p>Cloud image viewer</p>

      <form id="auth-form">
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit" id="login-btn">Log In</button>
        <button type="button" id="signup-btn">Sign Up</button>
      </form>

      <p id="auth-error" class="error-message"></p>
    </div>
  </div>

  <!-- Dashboard: Upload & Start -->
  <div id="dashboard" class="hidden">
    <div class="dashboard-content">
      <div class="dashboard-header">
        <h1>PicMachine</h1>
        <button id="logout-btn" class="logout-btn">Log Out</button>
      </div>

      <div class="upload-section">
        <div id="image-count">0</div>
        <label for="file-input" class="upload-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="17 8 12 3 7 8"></polyline>
            <line x1="12" y1="3" x2="12" y2="15"></line>
          </svg>
          Upload Images
          <input type="file" id="file-input" accept="image/*" multiple>
        </label>
        <div id="upload-progress" class="hidden">
          <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
          </div>
          <p id="progress-text">Uploading...</p>
        </div>
      </div>

      <div class="action-buttons">
        <button id="start-viewer-btn" class="start-btn">Start Viewing</button>
        <button id="manage-btn" class="manage-btn">Manage Images</button>
        <p class="hint">Arrow keys to navigate Â· ESC to exit Â· D to delete</p>
      </div>
    </div>
  </div>

  <!-- Gallery for Mass Delete -->
  <div id="gallery" class="hidden">
    <div class="gallery-header">
      <h1>Manage Images</h1>
      <div class="gallery-actions">
        <button id="select-all-btn" class="gallery-btn">Select All</button>
        <button id="deselect-all-btn" class="gallery-btn">Deselect All</button>
        <button id="delete-selected-btn" class="gallery-btn delete-btn-action" disabled>Delete Selected (0)</button>
        <button id="back-to-dashboard-btn" class="gallery-btn back-btn-action">Back</button>
      </div>
    </div>
    <div id="gallery-grid" class="gallery-grid"></div>
  </div>

  <!-- Image Viewer -->
  <div id="viewer" class="hidden">
    <img id="current-image" src="" alt="Image">
    <div id="counter"></div>
    <button id="delete-btn" class="delete-btn" title="Delete image (D)">ðŸ—‘</button>
    <button id="back-btn" class="nav-btn back-btn" title="Previous (â†)">â€¹</button>
    <button id="next-btn" class="nav-btn next-btn" title="Next (â†’)">â€º</button>
    <button id="viewer-exit-btn" class="viewer-exit-btn" title="Exit (ESC)">âœ•</button>
  </div>

  <!-- Loading Overlay -->
  <div id="loading" class="hidden">
    <div class="loader"></div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="delete-modal" class="modal hidden">
    <div class="modal-content">
      <p>Delete this image?</p>
      <div class="modal-buttons">
        <button id="confirm-delete" class="confirm-btn">Delete</button>
        <button id="cancel-delete" class="cancel-btn">Cancel</button>
      </div>
    </div>
  </div>

  <script src="supabase-config.js?v=5"></script>
  <script src="app.js?v=5"></script>
</body>
</html>
